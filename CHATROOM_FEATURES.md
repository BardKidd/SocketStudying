# 聊天室功能清單

## 📋 專案概述
本專案是一個基於 Socket.IO 的即時聊天室應用，旨在學習 WebSocket 技術和即時通信的實現。

## 🎯 功能分類

### 🔥 基礎功能 (高優先級)
> 這些是聊天室最核心的功能，必須優先實作

- [ ] **即時訊息傳送**
  - 支援文字訊息的即時傳遞
  - 使用 Socket.IO 實現雙向通信
  - 訊息格式標準化

- [ ] **多使用者同時連線**
  - 允許多個用戶同時在線聊天
  - 處理並發連線管理
  - 連線池管理

- [ ] **使用者識別**
  - 顯示誰發送了訊息
  - 用戶暱稱系統
  - 防止暱稱重複

- [ ] **連線狀態顯示**
  - 顯示用戶上線/離線狀態
  - 即時更新連線狀態
  - 連線/斷線事件通知

### 🚀 進階功能 (中優先級)
> 這些功能能提升聊天室的實用性和用戶體驗

- [ ] **私人訊息**
  - 一對一私聊功能
  - 私訊對象選擇
  - 私訊通知機制

- [ ] **聊天室/頻道**
  - 建立不同主題的聊天室
  - 房間管理功能
  - 用戶可自由加入/離開房間

- [ ] **使用者清單**
  - 顯示目前在線用戶
  - 用戶狀態指示器
  - 快速私訊功能

- [ ] **訊息歷史**
  - 保存和載入歷史訊息
  - 訊息持久化存儲
  - 歷史訊息分頁載入

- [ ] **檔案分享**
  - 支援圖片、檔案上傳
  - 檔案類型限制
  - 檔案大小限制

### 💫 使用者體驗 (中優先級)
> 這些功能專注於提升使用者的操作體驗

- [ ] **訊息通知**
  - 新訊息提醒
  - 桌面通知
  - 聲音提示

- [ ] **自動滾動**
  - 新訊息自動滾動到底部
  - 滾動到底部按鈕
  - 智能滾動控制

- [ ] **表情符號**
  - 支援 emoji 表情
  - 表情符號選擇器
  - 常用表情快捷鍵

- [ ] **訊息時間戳**
  - 顯示發送時間
  - 時間格式化
  - 相對時間顯示

- [ ] **使用者頭像**
  - 個人化頭像顯示
  - 默認頭像系統
  - 頭像上傳功能

### ⚡ 技術特性 (中優先級)
> 這些功能關注技術實現和穩定性

- [ ] **離線重連**
  - 網路斷線後自動重新連線
  - 重連機制優化
  - 斷線狀態提示

- [ ] **訊息狀態**
  - 顯示訊息發送/接收狀態
  - 訊息傳送確認
  - 訊息失敗重試

- [ ] **輸入提示**
  - 顯示其他用戶正在輸入
  - 輸入狀態廣播
  - 輸入超時處理

- [ ] **響應式設計**
  - 支援手機、平板、桌面
  - 適配不同螢幕尺寸
  - 觸控操作友好

## 📊 開發優先級

### 第零階段：認證系統 (前置需求)
> 在實現聊天室功能前必須先建立完整的用戶認證系統

#### 🎨 認證頁面
- [x] **咖啡廳風格註冊頁面**
  - [x] 使用 shadcn/ui 組件 (Form, Input, Button)
  - [x] 表單驗證 (name 必填, email 格式, password 8字元)
  - [x] 咖啡廳配色設計 (深底淺字)
  - [x] 錯誤處理和成功跳轉
  - [x] Toast 通知系統整合

- [x] **咖啡廳風格登入頁面**
  - [x] 使用 shadcn/ui 組件 + TypeScript
  - [x] 表單驗證 (email 格式, password 必填)
  - [x] 一致的設計風格和配色
  - [x] 登入成功後跳轉到主頁面
  - [x] Toast 通知系統整合

#### 🛣️ 路由與保護
- [x] **認證路由配置**
  - [x] `/register` 和 `/login` 路由
  - [x] 認證頁面獨立布局 (無 navbar)
  - [x] 受保護頁面使用 ProtectedLayout (有 navbar)

- [ ] **路由保護機制**
  - [ ] JWT 認證檢查
  - [ ] 未登入自動重導向到登入頁面
  - [ ] 已登入避免重複訪問認證頁面

#### 🔐 Token 管理
- [ ] **JWT 認證整合**
  - [ ] AuthContext 狀態管理
  - [ ] localStorage Token 儲存
  - [ ] 自動登出機制

#### 🔌 Socket.IO 認證
- [ ] **Socket 認證升級**
  - [ ] 連接時攜帶 JWT Token
  - [ ] 後端 Gateway JWT 驗證
  - [ ] 用戶身份與 Socket 綁定

#### 🔧 後端 API 優化
- [x] **統一 API 回應格式**
  - [x] ApiResponseDto 建立
  - [x] 統一格式：`{ status: number, message: string[], data: any | null }`
  - [x] 認證 API 格式更新
  - [x] 全局異常過濾器更新
  - [x] 錯誤狀態碼修正 (email重複 401→409)

### 第一階段：核心功能
> ⚠️ **前置條件**: 必須完成第零階段認證系統

1. **即時訊息傳送** (升級)
   - 訊息顯示真實用戶名 (不是 Socket ID)
   - 使用 JWT 用戶資訊
2. **多使用者同時連線** (升級)  
   - 已認證用戶的連線管理
   - 連線時驗證 JWT Token
3. **使用者識別** (重新實現)
   - 基於 JWT 的真實用戶識別
   - 防止未認證用戶訪問
4. **連線狀態顯示** (升級)
   - 顯示真實用戶的上線/離線狀態

### 第二階段：基礎體驗
1. 訊息時間戳
2. 自動滾動
3. **使用者清單** (升級)
   - 顯示真實用戶名列表 (不是 Socket ID)
   - 基於 JWT 的用戶資訊
4. 響應式設計

### 第三階段：進階功能
1. **私人訊息** (升級)
   - 支援用戶名選擇 (不只是 Socket ID)
2. 聊天室/頻道
3. 離線重連
4. 訊息狀態

### 第四階段：完整體驗
1. 訊息歷史
2. 訊息通知
3. 檔案分享
4. 輸入提示

### 第五階段：美化與優化
1. 表情符號
2. 使用者頭像
3. 其他 UI/UX 優化

## 🛠️ 技術架構

### 前端技術
- **React** - 用戶界面框架
- **Socket.IO Client** - WebSocket 客戶端
- **Tailwind CSS** - 樣式框架
- **React Router** - 路由管理

### 後端技術
- **NestJS** - Node.js 框架
- **Socket.IO** - WebSocket 服務端
- **TypeORM** - 數據庫 ORM
- **MySQL** - 關係型數據庫
- **JWT** - 用戶認證

## 📝 學習重點

1. **Socket.IO 基礎**
   - 事件驅動通信
   - 房間 (Room) 概念
   - 廣播機制

2. **即時應用架構**
   - 前後端分離
   - 狀態管理
   - 錯誤處理

3. **用戶體驗設計**
   - 即時反饋
   - 加載狀態
   - 錯誤提示

4. **性能優化**
   - 連線管理
   - 訊息批處理
   - 記憶體管理

## 🎯 完成標準

每個功能完成後應該滿足：
- [ ] 功能正常運作
- [ ] 用戶界面友好
- [ ] 錯誤處理完善
- [ ] 代碼有適當註解
- [ ] 通過基本測試

---

**注意事項**：
- 這是一個學習導向的專案，重點在於理解概念和實作過程
- 建議按照優先級順序逐步實現功能
- 每完成一個功能後，記得測試和優化
- 可以根據實際需求調整功能優先級

**最後更新時間**：2025-07-11